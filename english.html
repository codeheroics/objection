<!doctype html>
<html>
<head>
  <title>OBJECTION!</title>
  <style type="text/css">
    #objection {
      transition: all 100ms ease-out;
      z-index: -1;
    }
    .big {
      -moz-transform: scale(1.3, 1.3);
    }
    .small {
      -moz-transform: scale(0.5, 0.5);
    }
  </style>
  <script>
    var LEFT = 'left';
    var RIGHT = 'right';
    var objectionObjects = [];
    var characterPics = {
      phoenix: {
        picture: "phoenix.gif",
        facing: RIGHT
      },
      miles: {
        picture: "miles.gif",
        facing: LEFT
      },
      manfred: {
        picture: "manfred.gif",
        facing: LEFT
      },
      franziska: {
        picture: "franziska.gif",
        facing: LEFT
      },
      godot: {
        picture: "godot.gif",
        facing: LEFT
      },
      mia: {
        picture: "mia.gif",
        facing: RIGHT
      },
      calisto: {
        picture: "calisto.gif",
        facing: LEFT
      },
      quercus: {
        picture: "quercus.gif",
        facing: LEFT
      },
      jacques: {
        picture: "jacques.gif",
        facing: LEFT
      },
      klavier: {
        picture: "klavier.gif",
        facing: LEFT
      },
      kristoph: {
        picture: "kristoph.gif",
        facing: LEFT
      },
      calisto: {
        picture: "calisto.gif",
        facing: LEFT
      },
      winston: {
        picture: "winston.gif",
        facing: LEFT
      },
      apollo: {
        picture: "apollo.gif",
        facing: RIGHT
      }
    }

    var nextPosition = LEFT;
    var nextDiv = 'leftCharacter';

    function replaceImgElement(objectionObject, div) {
      var img=document.createElement('img');
      img.setAttribute('src', 'pictures/' + objectionObject.picture);
      img.setAttribute('height', '200');
      if (nextPosition === objectionObject.facing) {
        img.style.transform = 'scale(-1, 1)';
      }
      div.replaceChild(img, div.firstChild);
    }

    function prepareNextObjection() {
      setTimeout(function() {
        requiredDivId = (nextPosition === LEFT) ? 'leftCharacter' : 'rightCharacter';
        var random = Math.floor(Math.random() * objectionObjects.length);
        var objectionObject = objectionObjects[random];
        replaceImgElement(objectionObject, document.getElementById(requiredDivId));
        objectionObject.audioElement.play();

        if (nextPosition === LEFT){
          nextPosition = RIGHT;
          nextDiv = 'rightCharacter';
        } else {
          nextPosition = LEFT;
          nextDiv = 'leftCharacter';
        }
        prepareNextObjection();
      }, Math.random() * 13000 + 2000)
    }

    document.addEventListener("DOMContentLoaded", function() {
      audioElementsNodeList = document.getElementsByTagName('audio');
      for (var i = 0; i < audioElementsNodeList.length; i++) {
        character = audioElementsNodeList[i].className;
        objectionObjects.push({
          audioElement: audioElementsNodeList[i],
          picture: characterPics[character].picture,
          facing: characterPics[character].facing
        });
        audioElementsNodeList[i].addEventListener('play', function() {
          document.getElementById('objection').className = 'big';
        });
        audioElementsNodeList[i].addEventListener('pause', function() {
          document.getElementById('objection').className = 'small';
        });
      }

      prepareNextObjection();
    });

  
  </script>
</head>
<body>
  <header style="text-align:center;">
    <img src="pictures/objection.png" alt="OBJECTION" height="400" />
  </header>
  <div style="text-align:center;">
    <span id="leftCharacter"><img src="pictures/badger.gif" height="250" /></span>
    <img id="objection" src="pictures/objection.png" height="250" />
    <span id="rightCharacter"><img src="pictures/badger.gif" height="250" /></span>
  </div>
  <div>
    <audio class="quercus" src="english/objection (1).wav">No audio tag support in your browser :(</audio>
    <audio class="apollo" src="english/objection (2).wav">No audio tag support in your browser :(</audio>
    <audio class="calisto" src="english/objection (3).wav">No audio tag support in your browser :(</audio>
    <audio class="godot" src="english/objection (4).wav">No audio tag support in your browser :(</audio>
    <audio class="klavier" src="english/objection (5).wav">No audio tag support in your browser :(</audio>
    <audio class="kristoph" src="english/objection (6).wav">No audio tag support in your browser :(</audio>
    <audio class="mia" src="english/objection (7).wav">No audio tag support in your browser :(</audio>
    <audio class="miles" src="english/objection (8).wav">No audio tag support in your browser :(</audio>
    <audio class="franziska" src="english/objection (9).wav">No audio tag support in your browser :(</audio>
    <audio class="manfred" src="english/objection (10).wav">No audio tag support in your browser :(</audio>
    <audio class="winston" src="english/objection (11).wav">No audio tag support in your browser :(</audio>
    <audio class="phoenix" src="english/objection (12).wav">No audio tag support in your browser :(</audio>
  </div>
</body>
</html>